
function [data,options] = SFM_ET_invCorrAnalysis(data,options)

addpath(genpath('/home/shaw-raid1/matlab_tools/mpsCode'));

%% For all behavioral events, grab X seconds of data before and after
% data=rmfield(data,'invCorr')
for iI = 1:length(data.et.B.subjID)   % Subjs
    % Double check the partipant is the same in et and behav
    if data.behav.subjID(iI)==data.et.B.subjID(iI)
        % Update which participant
        fprintf('%s%d\n','Finding corresponding eye/behav events for: P',data.et.B.subjID(iI))
        for iZ = 1:size(data.et.B.date,2)   % B/Z day
            % Only look at participats/runs that have ET data
            if ~isnan(data.et.B.date(iI,iZ))
                for iJ = 1:length(data.behav.B.flipTimes{iI,iZ})   % For each block
                    % Check to make sure there are behav events for this block
                    if ~isempty(data.behav.B.flipTimes{iI,iZ}{iJ})
                        for iE = 1:length(data.behav.B.flipTimes{iI,iZ}{iJ})   % For all behav events
                            for iL = 1:3   % For left/right/both eye
                                %% For all events, create a nBinsx1 array
                                % Blinks
                                data.invCorr.B.corrData_blink{iI,iZ}{iJ}(iE,iL,:) = zeros([length(options.corrWindow) 1]);
                                % Saccs
                                data.invCorr.B.corrData_sacc{iI,iZ}{iJ}(iE,iL,:) = zeros([length(options.corrWindow) 1]);
                                
                                if iL<3
                                    %% For eye events from either eye
                                    %% If there are blinks for this trial
                                    if isfield(data.et.B.blinkStartTime{iI,iZ}{iJ},options.eyeType{iL})
                                        % If there are blinks for this trial
                                        if ~isempty(data.et.B.blinkStartTime{iI,iZ}{iJ}.(options.eyeType{iL}))
                                            
                                            clear eventDiffHolder eventDiffIdx
                                            
                                            % For all blinks, find the difference in time between them and the behav event.
                                            eventDiffHolder = data.et.B.blinkStartTime{iI,iZ}{iJ}.(options.eyeType{iL})-...
                                                data.behav.B.flipTimes{iI,iZ}{iJ}(iE);
                                            
                                            % Find blinks where the difference falls between the bounds of the window
                                            eventDiffIdx = find(eventDiffHolder<options.corrWindow(end) & eventDiffHolder>options.corrWindow(1));
                                            
                                            % For each point in the sampling array check if there's an eye event that falls between
                                            % it and the next event.
                                            for iM = 1:length(eventDiffIdx)
                                                for iK = 1:length(data.invCorr.B.corrData_blink{iI,iZ}{iJ}(iE,iL,:))
                                                    if eventDiffHolder(eventDiffIdx(iM))>=options.corrWindow(iK) &&...
                                                            eventDiffHolder(eventDiffIdx(iM))<options.corrWindow(iK)+options.downSampleBinWidth
                                                        data.invCorr.B.corrData_blink{iI,iZ}{iJ}(iE,iL,iK) =...
                                                            data.invCorr.B.corrData_blink{iI,iZ}{iJ}(iE,iL,iK)+1;
                                                    end
                                                end
                                            end
                                        end
                                    end
                                    
                                    %% If there are sacc starts for this eye
                                    if isfield(data.et.B.saccStartTime{iI,iZ}{iJ},options.eyeType{iL})
                                        % If there are saccs for this trial
                                        if ~isempty(data.et.B.saccStartTime{iI,iZ}{iJ}.(options.eyeType{iL}))
                                            
                                            clear eventDiffHolder eventDiffIdx
                                            
                                            % For all saccs, find the difference in time between them and the behav event.
                                            eventDiffHolder = data.et.B.saccStartTime{iI,iZ}{iJ}.(options.eyeType{iL})-...
                                                data.behav.B.flipTimes{iI,iZ}{iJ}(iE);
                                            
                                            % Find saccs where the difference falls between the bounds of the window
                                            eventDiffIdx = find(eventDiffHolder<options.corrWindow(end) & eventDiffHolder>options.corrWindow(1));
                                            
                                            % For each point in the sampling array check if there's an eye event that falls between
                                            % it and the next event.
                                            for iM = 1:length(eventDiffIdx)
                                                for iK = 1:length(data.invCorr.B.corrData_sacc{iI,iZ}{iJ}(iE,iL,:))
                                                    if eventDiffHolder(eventDiffIdx(iM))>=options.corrWindow(iK) &&...
                                                            eventDiffHolder(eventDiffIdx(iM))<options.corrWindow(iK)+options.downSampleBinWidth
                                                        data.invCorr.B.corrData_sacc{iI,iZ}{iJ}(iE,iL,iK) =...
                                                            data.invCorr.B.corrData_sacc{iI,iZ}{iJ}(iE,iL,iK)+1;
                                                    end
                                                end
                                            end
                                        end
                                    end
                                else
                                    %% For eye events from both eyes
                                    %% If there are blinks for this trial
                                    if isfield(data.et.B.blinkStartTime{iI,iZ}{iJ},options.eyeType{1}) && ...
                                            isfield(data.et.B.blinkStartTime{iI,iZ}{iJ},options.eyeType{2})
                                        % If there are blinks for this trial
                                        if ~isempty(data.et.B.blinkStartTime{iI,iZ}{iJ}.(options.eyeType{1})) && ...
                                                ~isempty(data.et.B.blinkStartTime{iI,iZ}{iJ}.(options.eyeType{2}))
                                            
                                            clear eventDiffHolderL eventDiffHolderR eventDiffIdxL eventDiffIdxR
                                            
                                            % For all blinks, find the difference in time between them and the behav event.
                                            eventDiffHolderL = data.et.B.blinkStartTime{iI,iZ}{iJ}.(options.eyeType{1})-...
                                                data.behav.B.flipTimes{iI,iZ}{iJ}(iE);
                                            eventDiffHolderR = data.et.B.blinkStartTime{iI,iZ}{iJ}.(options.eyeType{2})-...
                                                data.behav.B.flipTimes{iI,iZ}{iJ}(iE);
                                            
                                            % Find blinks where the difference falls between the bounds of the window
                                            eventDiffIdxL = find(eventDiffHolderL<options.corrWindow(end) &...
                                                eventDiffHolderL>options.corrWindow(1));
                                            eventDiffIdxR = find(eventDiffHolderR<options.corrWindow(end) &...
                                                eventDiffHolderR>options.corrWindow(1));
                                            
                                            % For each point in the sampling array check if there's an eye event that falls between
                                            % it and the next event.
                                            for iK = 1:length(data.invCorr.B.corrData_blink{iI,iZ}{iJ}(iE,3,:))
                                                clear windowDiffL windowDiffR
                                                windowDiffL = options.corrWindow(iK) - eventDiffHolderL(eventDiffIdxL);
                                                windowDiffR = options.corrWindow(iK) - eventDiffHolderR(eventDiffIdxR);
                                                if sum(windowDiffL >= 0 &...
                                                        windowDiffL < options.downSampleBinWidth) &...
                                                        sum(windowDiffR >= 0 &...
                                                        windowDiffR < options.downSampleBinWidth)
                                                    data.invCorr.B.corrData_blink{iI,iZ}{iJ}(iE,3,iK) =...
                                                        data.invCorr.B.corrData_blink{iI,iZ}{iJ}(iE,3,iK)+1;
                                                end
                                            end
                                        end
                                    end
                                    
                                    %% If there are saccs for this trial
                                    if isfield(data.et.B.saccStartTime{iI,iZ}{iJ},options.eyeType{1}) && ...
                                            isfield(data.et.B.saccStartTime{iI,iZ}{iJ},options.eyeType{2})
                                        % If there are saccs for this trial
                                        if ~isempty(data.et.B.saccStartTime{iI,iZ}{iJ}.(options.eyeType{1})) && ...
                                                ~isempty(data.et.B.saccStartTime{iI,iZ}{iJ}.(options.eyeType{2}))
                                            
                                            clear eventDiffHolderL eventDiffHolderR eventDiffIdxL eventDiffIdxR
                                            
                                            % For all saccs, find the difference in time between them and the behav event.
                                            eventDiffHolderL = data.et.B.saccStartTime{iI,iZ}{iJ}.(options.eyeType{1})-...
                                                data.behav.B.flipTimes{iI,iZ}{iJ}(iE);
                                            eventDiffHolderR = data.et.B.saccStartTime{iI,iZ}{iJ}.(options.eyeType{2})-...
                                                data.behav.B.flipTimes{iI,iZ}{iJ}(iE);
                                            
                                            % Find saccs where the difference falls between the bounds of the window
                                            eventDiffIdxL = find(eventDiffHolderL<options.corrWindow(end) &...
                                                eventDiffHolderL>options.corrWindow(1));
                                            eventDiffIdxR = find(eventDiffHolderR<options.corrWindow(end) &...
                                                eventDiffHolderR>options.corrWindow(1));
                                            
                                            % For each point in the sampling array check if there's an eye event that falls between
                                            % it and the next event.
                                            for iK = 1:length(data.invCorr.B.corrData_sacc{iI,iZ}{iJ}(iE,3,:))
                                                clear windowDiffL windowDiffR
                                                windowDiffL = options.corrWindow(iK) - eventDiffHolderL(eventDiffIdxL);
                                                windowDiffR = options.corrWindow(iK) - eventDiffHolderR(eventDiffIdxR);
                                                if sum(windowDiffL >= 0 &...
                                                        windowDiffL < options.downSampleBinWidth) &...
                                                        sum(windowDiffR >= 0 &...
                                                        windowDiffR < options.downSampleBinWidth)
                                                    data.invCorr.B.corrData_sacc{iI,iZ}{iJ}(iE,3,iK) =...
                                                        data.invCorr.B.corrData_sacc{iI,iZ}{iJ}(iE,3,iK)+1;
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    else
                    end
                end
                
                % Combine all events across blocks into one array (Xtotal behav events x 2eyes/comb eyes x 2000 timepoints)
                data.invCorr.B.corrData_blink_allBlocks{iI,iZ} = cat(1,data.invCorr.B.corrData_blink{iI,iZ}{:});
                data.invCorr.B.corrData_sacc_allBlocks{iI,iZ} = cat(1,data.invCorr.B.corrData_sacc{iI,iZ}{:});
                
                % For each subj combine across all events
%                 data.invCorr.B.corrData_blink_aveBlock{iI,iZ} = ...
%                     squeeze(nanmean(data.invCorr.B.corrData_blink_allBlocks{iI,iZ},1));
%                 data.invCorr.B.corrData_sacc_aveBlock{iI,iZ} = ...
%                     squeeze(nanmean(data.invCorr.B.corrData_sacc_allBlocks{iI,iZ},1));
                holderData.corrData_blink_aveBlock{iI,iZ} = ...
                    squeeze(nanmean(data.invCorr.B.corrData_blink_allBlocks{iI,iZ},1)).*100;
                holderData.corrData_sacc_aveBlock{iI,iZ} = ...
                    squeeze(nanmean(data.invCorr.B.corrData_sacc_allBlocks{iI,iZ},1)).*100;
            else
            end
        end
    else
        error('Subj ID in behav and et files don''t match!')
    end
end


%% Average
% Turn empty cells into nanarrays to average
for iI=1:size(holderData.corrData_blink_aveBlock,1)   % Subjs
    for iZ=1:size(holderData.corrData_blink_aveBlock,2)   % B/Z
        if isempty(holderData.corrData_blink_aveBlock{iI,iZ})
            holderData.corrData_blink_aveBlock{iI,iZ} = ...
                NaN([3 length(options.corrWindow)]);
        end
        if isempty(holderData.corrData_sacc_aveBlock{iI,iZ})
            holderData.corrData_sacc_aveBlock{iI,iZ} = ...
                NaN([3 length(options.corrWindow)]);
        end
        
        % Restructure holderData into the data structure for easier
        % averaging and use in ANOVAN for stats.
        data.invCorr.B.corrData_blink_aveBlock(iI,iZ,:,:) = ...
            holderData.corrData_blink_aveBlock{iI,iZ};
        data.invCorr.B.corrData_sacc_aveBlock(iI,iZ,:,:) = ...
            holderData.corrData_sacc_aveBlock{iI,iZ};
    end
    
    % Collapse across B/Z
    squeeze(nanmean(data.invCorr.B.corrData_blink_aveBlock(iI,:,:,:),2))
    data.invCorr.B.corrData_blink_aveDay(iI,:,:) = squeeze(nanmean(data.invCorr.B.corrData_blink_aveBlock(iI,:,:,:),2));
    data.invCorr.B.corrData_sacc_aveDay(iI,:,:) = squeeze(nanmean(data.invCorr.B.corrData_sacc_aveBlock(iI,:,:,:),2));
end
clear holderData

% Collapse across subjects
% All subj
% Blink
data.invCorr.B.corrData_blink_aveFull(:,:) = ...
    squeeze(nanmean(data.invCorr.B.corrData_blink_aveDay(:,:,:),1));   % Ave
data.invCorr.B.corrData_blink_steFull(:,:) = ...
    squeeze(nanstd(data.invCorr.B.corrData_blink_aveDay(:,:,:),1)) ./ ...
    sqrt(size(data.invCorr.B.corrData_blink_aveDay(:,:,:),1));   % STE
% Sacc
data.invCorr.B.corrData_sacc_aveFull(:,:) = ...
    squeeze(nanmean(data.invCorr.B.corrData_sacc_aveDay(:,:,:),1));
data.invCorr.B.corrData_sacc_steFull(:,:) = ...
    squeeze(nanstd(data.invCorr.B.corrData_sacc_aveDay(:,:,:),1)) ./ ...
    sqrt(size(data.invCorr.B.corrData_sacc_aveDay(:,:,:),1));
% Break down into groups
for iI=1:3
    % Blinks
    data.invCorr.B.corrData_blink_aveGrp(iI,:,:) = ...
        nanmean(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},:,:),1);   % Ave
    data.invCorr.B.corrData_blink_steGrp(iI,:,:) = ...
        nanstd(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},:,:),1) ./ ...
        sqrt(length(data.et.B.grpIdx{iI}));   % STE
    % Saccades
    data.invCorr.B.corrData_sacc_aveGrp(iI,:,:) = ...
        nanmean(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},:,:),1);
    data.invCorr.B.corrData_sacc_steGrp(iI,:,:) = ...
        nanstd(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},:,:),1) ./ ...
        sqrt(length(data.et.B.grpIdx{iI}));
end

% Average across the two eyes
% Average both eyes together first, then collapse across subjects
% All subjects
data.invCorr.B.corrData_blink_aveFull_bothEyes(:) =...
    squeeze(nanmean(squeeze(nanmean(data.invCorr.B.corrData_blink_aveDay(:,1:2,:),2)),1));
data.invCorr.B.corrData_sacc_aveFull_bothEyes(:) =...
    squeeze(nanmean(squeeze(nanmean(data.invCorr.B.corrData_sacc_aveDay(:,1:2,:),2)),1));
% Break down into groups
for iI=1:3
    % Blinks
    data.invCorr.B.corrData_blink_aveGrp_bothEyes(iI,:) =...
        nanmean(squeeze(nanmean(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},1:2,:),2)),1);
    % Saccades
    data.invCorr.B.corrData_sacc_aveGrp_bothEyes(iI,:) =...
        nanmean(squeeze(nanmean(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},1:2,:),2)),1);
end


%% Stats
baselineRange = find(options.corrWindow==-9050):find(options.corrWindow==-2000);
peakRange = find(options.corrWindow==-1100):find(options.corrWindow==-900);
troughRange = find(options.corrWindow==-600):find(options.corrWindow==-100);

%% Average baseline/peak/trough across all subjects
% For blinks
% Find the average baseline of combined eye events (from -9.5 to -2s)
data.invCorr.B.stats.baseline_blink_Ave = ...
    nanmean(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    baselineRange))));
data.invCorr.B.stats.baseline_blink_Ste = ...
    std(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    baselineRange)))) ./ sqrt(length(baselineRange));
% Find the average peak of combined eye events ()
data.invCorr.B.stats.peak_blink_Ave = ...
    nanmean(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    peakRange))));
data.invCorr.B.stats.peak_blink_Ste = ...
    std(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    peakRange)))) ./ sqrt(length(peakRange));
% Find the average of the trough window before behav event ()
data.invCorr.B.stats.trough_blink_Ave = ...
    nanmean(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    troughRange))));
data.invCorr.B.stats.trough_blink_Ste = ...
    std(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    troughRange)))) ./ sqrt(length(troughRange));

% Run ttest between the baseline and peak / baseline and trough
% (ttest between ave peak for each subject and baseline)
% Peak
[~,data.invCorr.B.stats.peak_blink_AveTtest_p,~,...
    data.invCorr.B.stats.peak_blink_AveTtest_stats] = ...
    ttest(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    peakRange)),2),...
    data.invCorr.B.stats.baseline_blink_Ave);
% Trough
[~,data.invCorr.B.stats.trough_blink_AveTtest_p,~,...
    data.invCorr.B.stats.trough_blink_AveTtest_stats] = ...
    ttest(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,...
    troughRange)),2),...
    data.invCorr.B.stats.baseline_blink_Ave);

% For saccs
% Find the average baseline of combined eye events (from -9.5 to -2s)
data.invCorr.B.stats.baseline_sacc_Ave = ...
    nanmean(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    baselineRange))));
data.invCorr.B.stats.baseline_sacc_Ste = ...
    std(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    baselineRange)))) ./ sqrt(length(baselineRange));
% Find the average peak of combined eye events ()
data.invCorr.B.stats.peak_sacc_Ave = ...
    nanmean(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    peakRange))));
data.invCorr.B.stats.peak_sacc_Ste = ...
    std(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    peakRange)))) ./ sqrt(length(peakRange));
% Find the average of the trough window before behav event ()
data.invCorr.B.stats.trough_sacc_Ave = ...
    nanmean(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    troughRange))));
data.invCorr.B.stats.trough_sacc_Ste = ...
    std(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    troughRange)))) ./ sqrt(length(troughRange));

% Run ttest between the baseline and peak / baseline and trough
% (ttest between ave peak for each subject and baseline)
% Peak
[~,data.invCorr.B.stats.peak_sacc_AveTtest_p,~,...
    data.invCorr.B.stats.peak_sacc_AveTtest_stats] = ...
    ttest(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    peakRange)),2),...
    data.invCorr.B.stats.baseline_sacc_Ave);
% Trough
[~,data.invCorr.B.stats.trough_sacc_AveTtest_p,~,...
    data.invCorr.B.stats.trough_sacc_AveTtest_stats] = ...
    ttest(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,...
    troughRange)),2),...
    data.invCorr.B.stats.baseline_sacc_Ave);

%% Average baseline/peak/trough across groups
for iI=1:3
    % For blinks
    % Baseline for groups
    data.invCorr.B.stats.baseline_blink_GrpAve(iI) = ...
        nanmean(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        baselineRange))));
    data.invCorr.B.stats.baseline_blink_GrpSte(iI) = ...
        std(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        baselineRange)))) ./ sqrt(length(baselineRange));
    % Peak for groups
    data.invCorr.B.stats.peak_blink_GrpAve(iI) = ...
        nanmean(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        peakRange))));
    data.invCorr.B.stats.peak_blink_GrpSte(iI) = ...
        std(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        peakRange)))) ./ sqrt(length(peakRange));
    % Trough for groups
    data.invCorr.B.stats.trough_blink_GrpAve(iI) = ...
        nanmean(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        troughRange))));
    data.invCorr.B.stats.trough_blink_GrpSte(iI) = ...
        std(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        troughRange)))) ./ sqrt(length(troughRange));
    
    % Run ttest between the baseline and peak / baseline and trough
    % (ttest between ave peak for each subject and baseline)
    % Peak
    [~,data.invCorr.B.stats.peak_blink_GrpTtest_p(iI),~,...
        data.invCorr.B.stats.peak_blink_GrpTtest_stats(iI)] = ...
        ttest(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        peakRange)),2),...
        data.invCorr.B.stats.baseline_blink_GrpAve(iI));
    % Trough
    [~,data.invCorr.B.stats.trough_blink_GrpTtest_p(iI),~,...
        data.invCorr.B.stats.trough_blink_GrpTtest_stats(iI)] = ...
        ttest(nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{iI},3,...
        troughRange)),2),...
        data.invCorr.B.stats.baseline_blink_GrpAve(iI));
    
    % For saccs
    % Baseline for groups
    data.invCorr.B.stats.baseline_sacc_GrpAve(iI) = ...
        nanmean(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        baselineRange))));
    data.invCorr.B.stats.baseline_sacc_GrpSte(iI) = ...
        std(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        baselineRange)))) ./ sqrt(length(baselineRange));
    % Peak for groups
    data.invCorr.B.stats.peak_sacc_GrpAve(iI) = ...
        nanmean(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        peakRange))));
    data.invCorr.B.stats.peak_sacc_GrpSte(iI) = ...
        std(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        peakRange)))) ./ sqrt(length(peakRange));
    % Trough for groups
    data.invCorr.B.stats.trough_sacc_GrpAve(iI) = ...
        nanmean(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        troughRange))));
    data.invCorr.B.stats.trough_sacc_GrpSte(iI) = ...
        std(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        troughRange)))) ./ sqrt(length(troughRange));
    
    % Run ttest between the baseline and peak / baseline and trough
    % (ttest between ave peak for each subject and baseline)
    % Peak
    [~,data.invCorr.B.stats.peak_sacc_GrpTtest_p(iI),~,...
        data.invCorr.B.stats.peak_sacc_GrpTtest_stats(iI)] = ...
        ttest(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        peakRange)),2),...
        data.invCorr.B.stats.baseline_sacc_GrpAve(iI));
    % Trough
    [~,data.invCorr.B.stats.trough_sacc_GrpTtest_p(iI),~,...
        data.invCorr.B.stats.trough_sacc_GrpTtest_stats(iI)] = ...
        ttest(nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{iI},3,...
        troughRange)),2),...
        data.invCorr.B.stats.baseline_sacc_GrpAve(iI));
end

%% Compare each time point with baseline
% Run ttest between average baseline
% Find the range over which to run the ttest
% ttestRange = find(options.corrWindow==-1750):find(options.corrWindow==0);
ttestRange = 1:length(options.corrWindow);
for iS = 1:length(ttestRange)
    % For blinks
    % All subjs
    [data.invCorr.B.stats.ttestBlink_Sig_Ave(iS),...
        data.invCorr.B.stats.ttestBlink_P_Ave(iS),~,...
        data.invCorr.B.stats.ttestBlink_Stats_Ave(iS)] =...
        ttest(data.invCorr.B.corrData_blink_aveDay(:,3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_blink_Ave);
    % Controls
    [data.invCorr.B.stats.ttestBlink_Sig_Grp(1,iS),...
        data.invCorr.B.stats.ttestBlink_P_Grp(1,iS),~,...
        data.invCorr.B.stats.ttestBlink_Stats_Grp(1,iS)] =...
        ttest(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{1},3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_blink_GrpAve(1));
    % Relatives
    [data.invCorr.B.stats.ttestBlink_Sig_Grp(2,iS),...
        data.invCorr.B.stats.ttestBlink_P_Grp(2,iS),~,...
        data.invCorr.B.stats.ttestBlink_Stats_Grp(2,iS)] =...
        ttest(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{2},3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_blink_GrpAve(2));
    % Psychosis
    [data.invCorr.B.stats.ttestBlink_Sig_Grp(3,iS),...
        data.invCorr.B.stats.ttestBlink_P_Grp(3,iS),~,...
        data.invCorr.B.stats.ttestBlink_Stats_Grp(3,iS)] =...
        ttest(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{3},3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_blink_GrpAve(3));
    
    % For saccs
    % All subjs
    [data.invCorr.B.stats.ttestSacc_Sig_Ave(iS),...
        data.invCorr.B.stats.ttestSacc_P_Ave(iS),~,...
        data.invCorr.B.stats.ttestSacc_Stats_Ave(iS)] =...
        ttest(data.invCorr.B.corrData_sacc_aveDay(:,3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_sacc_Ave);
    % Controls
    [data.invCorr.B.stats.ttestSacc_Sig_Grp(1,iS),...
        data.invCorr.B.stats.ttestSacc_P_Grp(1,iS),~,...
        data.invCorr.B.stats.ttestSacc_Stats_Grp(1,iS)] =...
        ttest(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{1},3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_sacc_GrpAve(1));
    % Relatives
    [data.invCorr.B.stats.ttestSacc_Sig_Grp(2,iS),...
        data.invCorr.B.stats.ttestSacc_P_Grp(2,iS),~,...
        data.invCorr.B.stats.ttestSacc_Stats_Grp(2,iS)] =...
        ttest(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{2},3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_sacc_GrpAve(2));
    % Psychosis
    [data.invCorr.B.stats.ttestSacc_Sig_Grp(3,iS),...
        data.invCorr.B.stats.ttestSacc_P_Grp(3,iS),~,...
        data.invCorr.B.stats.ttestSacc_Stats_Grp(3,iS)] =...
        ttest(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{3},3,ttestRange(iS)),...
        data.invCorr.B.stats.baseline_sacc_GrpAve(3));
end

%% Run ANOVAN and 3-KW to compare peaks across groups
% Blinks
% ANOVAN
% Run ANOVAN using B/Z visits seperately 
clear all_data grouping participant nest
all_data = [nanmean(squeeze(data.invCorr.B.corrData_blink_aveBlock(data.et.B.grpIdx{1},:,3,peakRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveBlock(data.et.B.grpIdx{2},:,3,peakRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveBlock(data.et.B.grpIdx{3},:,3,peakRange)),3)];
grouping = repmat([ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2],[1 2]);
participant = repmat((1:length(grouping))',[1 2]);
nest = zeros(2,2);
nest(2,1) = 1;
[data.invCorr.B.stats.anovanPeak_Blink.Sig_peak,...
    data.invCorr.B.stats.anovanPeak_Blink.Table_peak] = ...
    anovan(all_data(:),{grouping(:),participant(:)},'random',2,'nested',nest,...
    'varnames',{'group','participant'},'display','off');

% Run 3-KW Test
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{1},3,peakRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{2},3,peakRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{3},3,peakRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2];
[data.invCorr.B.stats.KW3_Peak_Blink.Sig_peak, ...
    data.invCorr.B.stats.KW3_Peak_Blink.Table_peak, ...
    data.invCorr.B.stats.KW3_Peak_Blink.Stats_peak] = ...
    kruskalwallis(all_data,grouping,'off');

% Saccs
% ANOVAN
% Run ANOVAN using B/Z visits seperately 
clear all_data grouping participant nest
all_data = [nanmean(squeeze(data.invCorr.B.corrData_sacc_aveBlock(data.et.B.grpIdx{1},:,3,peakRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveBlock(data.et.B.grpIdx{2},:,3,peakRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveBlock(data.et.B.grpIdx{3},:,3,peakRange)),3)];
grouping = repmat([ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2],[1 2]);
participant = repmat((1:length(grouping))',[1 2]);
nest = zeros(2,2);
nest(2,1) = 1;
[data.invCorr.B.stats.anovanPeak_Sacc.Sig_peak,...
    data.invCorr.B.stats.anovanPeak_Sacc.Table_peak] = ...
    anovan(all_data(:),{grouping(:),participant(:)},'random',2,'nested',nest,...
    'varnames',{'group','participant'},'display','off');

% Run 3-KW Test
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{1},3,peakRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{2},3,peakRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{3},3,peakRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2];
[data.invCorr.B.stats.KW3_Peak_Sacc.Sig_peak, ...
    data.invCorr.B.stats.KW3_Peak_Sacc.Table_peak, ...
    data.invCorr.B.stats.KW3_Peak_Sacc.Stats_peak] = ...
    kruskalwallis(all_data,grouping,'off');

%% Run ANOVAN and 3-KW to compare troughs across groups
% Blinks
% ANOVAN
% Run ANOVAN using B/Z visits seperately 
clear all_data grouping participant nest
all_data = [nanmean(squeeze(data.invCorr.B.corrData_blink_aveBlock(data.et.B.grpIdx{1},:,3,troughRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveBlock(data.et.B.grpIdx{2},:,3,troughRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveBlock(data.et.B.grpIdx{3},:,3,troughRange)),3)];
grouping = repmat([ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2],[1 2]);
participant = repmat((1:length(grouping))',[1 2]);
nest = zeros(2,2);
nest(2,1) = 1;
[data.invCorr.B.stats.anovanTrough_Blink.Sig_trough,...
    data.invCorr.B.stats.anovanTrough_Blink.Table_trough] = ...
    anovan(all_data(:),{grouping(:),participant(:)},'random',2,'nested',nest,...
    'varnames',{'group','participant'},'display','off');

% Run 3-KW Test
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{1},3,troughRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{2},3,troughRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{3},3,troughRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2];
[data.invCorr.B.stats.KW3_Trough_Blink.Sig_trough, ...
    data.invCorr.B.stats.KW3_Trough_Blink.Table_trough, ...
    data.invCorr.B.stats.KW3_Trough_Blink.Stats_trough] = ...
    kruskalwallis(all_data,grouping,'off');

% Saccs
% ANOVAN
% Run ANOVAN using B/Z visits seperately 
clear all_data grouping participant nest
all_data = [nanmean(squeeze(data.invCorr.B.corrData_sacc_aveBlock(data.et.B.grpIdx{1},:,3,troughRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveBlock(data.et.B.grpIdx{2},:,3,troughRange)),3);...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveBlock(data.et.B.grpIdx{3},:,3,troughRange)),3)];
grouping = repmat([ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2],[1 2]);
participant = repmat((1:length(grouping))',[1 2]);
nest = zeros(2,2);
nest(2,1) = 1;
[data.invCorr.B.stats.anovanTrough_Sacc.Sig_trough,...
    data.invCorr.B.stats.anovanTrough_Sacc.Table_trough] = ...
    anovan(all_data(:),{grouping(:),participant(:)},'random',2,'nested',nest,...
    'varnames',{'group','participant'},'display','off');

% Run 3-KW Test
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{1},3,troughRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{2},3,troughRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{3},3,troughRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{2}) 1])+1;...
    ones([length(data.et.B.grpIdx{3}) 1])+2];
[data.invCorr.B.stats.KW3_Trough_Sacc.Sig_trough, ...
    data.invCorr.B.stats.KW3_Trough_Sacc.Table_trough, ...
    data.invCorr.B.stats.KW3_Trough_Sacc.Stats_trough] = ...
    kruskalwallis(all_data,grouping,'off');

%% Run KW and ttest between controls and probands for peak
% Blink
% Run ttest
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{1},3,peakRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{3},3,peakRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{3}) 1])+1];
[data.invCorr.B.stats.TTest_Peak_Blink.Sig_peak, ...
    data.invCorr.B.stats.TTest_Peak_Blink.P_peak,~, ...
    data.invCorr.B.stats.TTest_Peak_Blink.Stats_peak] = ...
    ttest(all_data);

% Run 2-KW Test
[data.invCorr.B.stats.KW2_Peak_Blink.Sig_peak, ...
    data.invCorr.B.stats.KW2_Peak_Blink.Table_peak, ...
    data.invCorr.B.stats.KW2_Peak_Blink.Stats_peak] = ...
    kruskalwallis(all_data,grouping,'off');

% Sacc
% Run ttest
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{1},3,peakRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{3},3,peakRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{3}) 1])+1];
[data.invCorr.B.stats.TTest_Peak_Sacc.Sig_peak, ...
    data.invCorr.B.stats.TTest_Peak_Sacc.P_peak,~, ...
    data.invCorr.B.stats.TTest_Peak_Sacc.Stats_peak] = ...
    ttest(all_data);

% Run 2-KW Test
[data.invCorr.B.stats.KW2_Peak_Sacc.Sig_peak, ...
    data.invCorr.B.stats.KW2_Peak_Sacc.Table_peak, ...
    data.invCorr.B.stats.KW2_Peak_Sacc.Stats_peak] = ...
    kruskalwallis(all_data,grouping,'off');

%% Run 2KW and ttest between controls and probands for trough
% Blink
% Run ttest
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{1},3,troughRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(data.et.B.grpIdx{3},3,troughRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{3}) 1])+1];
[data.invCorr.B.stats.TTest_Trough_Blink.Sig_trough, ...
    data.invCorr.B.stats.TTest_Trough_Blink.P_trough,~, ...
    data.invCorr.B.stats.TTest_Trough_Blink.Stats_trough] = ...
    ttest(all_data);

% Run 2-KW Test
[data.invCorr.B.stats.KW2_Trough_Blink.Sig_trough, ...
    data.invCorr.B.stats.KW2_Trough_Blink.Table_trough, ...
    data.invCorr.B.stats.KW2_Trough_Blink.Stats_trough] = ...
    kruskalwallis(all_data,grouping,'off');

% Sacc
% Run ttest
clear all_data grouping
all_data = [nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{1},3,troughRange)),2); ...
    nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(data.et.B.grpIdx{3},3,troughRange)),2)];
grouping = [ones([length(data.et.B.grpIdx{1}) 1]);...
    ones([length(data.et.B.grpIdx{3}) 1])+1];
[data.invCorr.B.stats.TTest_Trough_Sacc.Sig_trough, ...
    data.invCorr.B.stats.TTest_Trough_Sacc.P_trough,~, ...
    data.invCorr.B.stats.TTest_Trough_Sacc.Stats_trough] = ...
    ttest(all_data);

% Run 2-KW Test
[data.invCorr.B.stats.KW2_Trough_Sacc.Sig_trough, ...
    data.invCorr.B.stats.KW2_Trough_Sacc.Table_trough, ...
    data.invCorr.B.stats.KW2_Trough_Sacc.Stats_trough] = ...
    kruskalwallis(all_data,grouping,'off');


%% Plot heat maps and average
% Group colors
col_list{1} = [0 1 0];
col_list{2} = [0 0 1];
col_list{3} = [1 0 0];
if options.displayETFigs
    %% Plot blinks seperate eye events
    blinkFig = figure();
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [10.9849 9.2814];   % Aspect ratio
    figSize.figSize = [0 0 ...
        figSize.baseSize(3)...
        figSize.baseSize(4)];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    
    % Left eye
    subplot(5,4,[1 2 5 6 9 10])
    % Plot heatmaps
    imagesc(squeeze(data.invCorr.B.corrData_blink_aveDay(:,1,:)))
    hold on
    plotSquareOffsetBottom = .5;
    plotSquareOffsetTop = .25;
    % Plot divider lines to seperate groups
    % Controls
    plotSquareCoordsX = [1, 1, length(options.corrWindow), length(options.corrWindow), 1];
    plotSquareCoordsY = [0+plotSquareOffsetBottom, size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop, 0+plotSquareOffsetBottom, 0+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'g','LineWidth',1.5)
    % Relatives
    plotSquareCoordsY = [size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'b','LineWidth',1.5)
    % Probands
    plotSquareCoordsY = [size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'r','LineWidth',1.5)
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 size(data.invCorr.B.corrData_blink_aveDay,1)],'w','LineWidth',1.5)
    
    title('Left Eye')
    set(gca,'YDir','normal',...
        'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ticklength',[0 0])
    box off
    colorbar()
    % set(gca,'XColor','w','YColor','w')
    
    % Plot average
    subplot(5,4,[13 14])
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(1,1,:)),'Color',[0 1 0])
    hold on
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(2,1,:)),'Color',[0 0 1])
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(3,1,:)),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_blink_aveFull(1,:),'--','Color',[0 0 0])
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',[0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))])
    legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Blinks Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Right eye
    subplot(5,4,[3 4 7 8 11 12])
    % Plot heatmaps
    imagesc(squeeze(data.invCorr.B.corrData_blink_aveDay(:,2,:)))
    hold on
    plotSquareOffsetBottom = .5;
    plotSquareOffsetTop = .25;
    % Plot divider lines to seperate groups
    % Controls
    plotSquareCoordsX = [1, 1, length(options.corrWindow), length(options.corrWindow), 1];
    plotSquareCoordsY = [0+plotSquareOffsetBottom, size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop, 0+plotSquareOffsetBottom, 0+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'g','LineWidth',1.5)
    % Relatives
    plotSquareCoordsY = [size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'b','LineWidth',1.5)
    % Probands
    plotSquareCoordsY = [size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'r','LineWidth',1.5)
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 size(data.invCorr.B.corrData_blink_aveDay,1)],'w','LineWidth',1.5)
    
    title('Right Eye')
    set(gca,'YDir','normal',...
        'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ticklength',[0 0])
    box off
    colorbar()
    % set(gca,'XColor','w','YColor','w')
    
    % Plot average
    subplot(5,4,[15 16])
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(1,2,:)),'Color',[0 1 0])
    hold on
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(2,2,:)),'Color',[0 0 1])
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(3,2,:)),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_blink_aveFull(2,:),'--','Color',[0 0 0])
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',[0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))])
    legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Blinks Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot average of both eyes
    subplot(5,4,[17:20])
    plot(data.invCorr.B.corrData_blink_aveGrp_bothEyes(1,:),'Color',[0 1 0])
    hold on
    plot(data.invCorr.B.corrData_blink_aveGrp_bothEyes(2,:),'Color',[0 0 1])
    plot(data.invCorr.B.corrData_blink_aveGrp_bothEyes(3,:),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_blink_aveFull_bothEyes(:),'--','Color',[0 0 0])
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',[0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))])
    legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Blinks Surrounding Behavioral Event (Ave of both eyes)')
    box off
    set(gca,'XColor','k','YColor','k')
    
    %% Plot saccs seperate eye events
    saccFig = figure();
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [10.9849 9.2814];   % Aspect ratio
    figSize.figSize = [0 0 ...
        figSize.baseSize(3)...
        figSize.baseSize(4)];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    
    % Left eye
    subplot(5,4,[1 2 5 6 9 10])
    % Plot heatmaps
    imagesc(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,1,:)))
    hold on
    plotSquareOffsetBottom = .5;
    plotSquareOffsetTop = .25;
    % Plot divider lines to seperate groups
    % Controls
    plotSquareCoordsX = [1, 1, length(options.corrWindow), length(options.corrWindow), 1];
    plotSquareCoordsY = [0+plotSquareOffsetBottom, size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop, 0+plotSquareOffsetBottom, 0+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'g','LineWidth',1.5)
    % Relatives
    plotSquareCoordsY = [size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'b','LineWidth',1.5)
    % Probands
    plotSquareCoordsY = [size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'r','LineWidth',1.5)
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 size(data.invCorr.B.corrData_sacc_aveDay,1)],'w','LineWidth',1.5)
    
    title('Left Eye')
    set(gca,'YDir','normal',...
        'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ticklength',[0 0])
    box off
    colorbar()
    % set(gca,'XColor','w','YColor','w')
    
    % Plot average
    subplot(5,4,[13 14])
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(1,1,:)),'Color',[0 1 0])
    hold on
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(2,1,:)),'Color',[0 0 1])
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(3,1,:)),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_sacc_aveFull(1,:),'--','Color',[0 0 0])
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5)
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',[0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))])
    legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Saccades Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Right eye
    subplot(5,4,[3 4 7 8 11 12])
    % Plot heatmaps
    imagesc(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,2,:)))
    hold on
    plotSquareOffsetBottom = .5;
    plotSquareOffsetTop = .25;
    % Plot divider lines to seperate groups
    % Controls
    plotSquareCoordsX = [1, 1, length(options.corrWindow), length(options.corrWindow), 1];
    plotSquareCoordsY = [0+plotSquareOffsetBottom, size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop, 0+plotSquareOffsetBottom, 0+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'g','LineWidth',1.5)
    % Relatives
    plotSquareCoordsY = [size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'b','LineWidth',1.5)
    % Probands
    plotSquareCoordsY = [size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'r','LineWidth',1.5)
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 size(data.invCorr.B.corrData_sacc_aveDay,1)],'w','LineWidth',1.5)
    
    title('Right Eye')
    set(gca,'YDir','normal',...
        'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ticklength',[0 0])
    box off
    colorbar()
    % set(gca,'XColor','w','YColor','w')
    
    % Plot average
    subplot(5,4,[15 16])
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(1,2,:)),'Color',[0 1 0])
    hold on
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(2,2,:)),'Color',[0 0 1])
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(3,2,:)),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_sacc_aveFull(2,:),'--','Color',[0 0 0])
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5)
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',[0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))])
    legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Saccades Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot average of both eyes
    subplot(5,4,[17:20])
    plot(data.invCorr.B.corrData_sacc_aveGrp_bothEyes(1,:),'Color',[0 1 0])
    hold on
    plot(data.invCorr.B.corrData_sacc_aveGrp_bothEyes(2,:),'Color',[0 0 1])
    plot(data.invCorr.B.corrData_sacc_aveGrp_bothEyes(3,:),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_sacc_aveFull_bothEyes(:),'--','Color',[0 0 0])
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5)
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',[0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))])
    legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Saccades Surrounding Behavioral Event (Ave of both eyes)')
    box off
    set(gca,'XColor','k','YColor','k')
    
    %% Plot blinks combined eye events
    blinkFigCombEye = figure();
    yAxisLims = [0 3];
    sigMarkerLoc = 2.9;
    sigMarkerOffset = .1;
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [10.9849 9.2814];   % Aspect ratio
        figSize.figSize = [0 0 ...
            figSize.baseSize(3)...
            figSize.baseSize(4)];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    
    subplot(4,4,[1:12])
    % Plot heatmaps
    imagesc(squeeze(data.invCorr.B.corrData_blink_aveDay(:,3,:)))
    hold on
    plotSquareOffsetBottom = .5;
    plotSquareOffsetTop = .25;
    % Plot divider lines to seperate groups
    % Controls
    plotSquareCoordsX = [1, 1, length(options.corrWindow), length(options.corrWindow), 1];
    plotSquareCoordsY = [0+plotSquareOffsetBottom, size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop, 0+plotSquareOffsetBottom, 0+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'g','LineWidth',1.5)
    % Relatives
    plotSquareCoordsY = [size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'b','LineWidth',1.5)
    % Probands
    plotSquareCoordsY = [size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'r','LineWidth',1.5)
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 size(data.invCorr.B.corrData_blink_aveDay,1)],'w','LineWidth',1.5)
    
    title('Probability of Blink Occuring in Both Eyes (%)')
    ylabel('Participant')
    set(gca,'YDir','normal',...
        'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ticklength',[0 0])
    box off
    colorbar()
    % set(gca,'XColor','w','YColor','w')
    
    % Plot average
    subplot(4,4,[13:16])
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(1,3,:)),'Color',[0 1 0])
    hold on
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(2,3,:)),'Color',[0 0 1])
    plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(3,3,:)),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_blink_aveFull(3,:),'--','Color',[0 0 0])
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Ave)]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Ave==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 0],'LineWidth',1.5)
    clear plotMarker
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Grp(1,:))]) + sigMarkerLoc-sigMarkerOffset; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Grp(1,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 1 0],'LineWidth',1.5)
    clear plotMarker
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Grp(2,:))]) + sigMarkerLoc-sigMarkerOffset*2; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Grp(2,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 1],'LineWidth',1.5)
    clear plotMarker
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Grp(3,:))]) + sigMarkerLoc-sigMarkerOffset*3; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Grp(3,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[1 0 0],'LineWidth',1.5)
    clear plotMarker
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',yAxisLims)
%     legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Average Probability of Blink')
    ylabel('Probability (%)')
    xlabel('Time Relative to Event Onset (s)')
    box off
    set(gca,'XColor','k','YColor','k')
    
    %% Plot saccades combined eye events
    saccFigCombEye = figure();
    yAxisLims = [0 13.7];
    sigMarkerLoc = 13.3;
    sigMarkerOffset = .4;
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [10.9849 9.2814];   % Aspect ratio
        figSize.figSize = [0 0 ...
            figSize.baseSize(3)...
            figSize.baseSize(4)];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    
    subplot(4,4,[1:12])
    % Plot heatmaps
    imagesc(squeeze(data.invCorr.B.corrData_sacc_aveDay(:,3,:)))
    hold on
    plotSquareOffsetBottom = .5;
    plotSquareOffsetTop = .25;
    % Plot divider lines to seperate groups
    % Controls
    plotSquareCoordsX = [1, 1, length(options.corrWindow), length(options.corrWindow), 1];
    plotSquareCoordsY = [0+plotSquareOffsetBottom, size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop, 0+plotSquareOffsetBottom, 0+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'g','LineWidth',1.5)
    % Relatives
    plotSquareCoordsY = [size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'b','LineWidth',1.5)
    % Probands
    plotSquareCoordsY = [size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{3},1)+size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetTop,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom,...
        size(data.et.B.grpIdx{2},1)+size(data.et.B.grpIdx{1},1)+plotSquareOffsetBottom];
    plot(plotSquareCoordsX,plotSquareCoordsY,'r','LineWidth',1.5)
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 size(data.invCorr.B.corrData_sacc_aveDay,1)],'w','LineWidth',1.5)
    
    title('Probability of Saccade Occuring in Both Eyes (%)')
    ylabel('Participant')
    set(gca,'YDir','normal',...
        'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ticklength',[0 0])
    box off
    colorbar()
    % set(gca,'XColor','w','YColor','w')
    
    % Plot average
    subplot(4,4,[13:16])
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(1,3,:)),'Color',[0 1 0])
    hold on
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(2,3,:)),'Color',[0 0 1])
    plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(3,3,:)),'Color',[1 0 0])
    plot(data.invCorr.B.corrData_sacc_aveFull(3,:),'--','Color',[0 0 0])
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Ave)]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Ave==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 0],'LineWidth',1.5)
    clear plotMarker
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Grp(1,:))]) + sigMarkerLoc-sigMarkerOffset; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Grp(1,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 1 0],'LineWidth',1.5)
    clear plotMarker
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Grp(2,:))]) + sigMarkerLoc-sigMarkerOffset*2; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Grp(2,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 1],'LineWidth',1.5)
    clear plotMarker
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Grp(3,:))]) + sigMarkerLoc-sigMarkerOffset*3; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Grp(3,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[1 0 0],'LineWidth',1.5)
    clear plotMarker
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],[0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5)
    
    set(gca,'xlim',[0 length(options.corrWindow)],...
        'xtick',round(linspace(1,length(options.corrWindow),5)),...
        'xticklabels',round(options.corrWindow(round(linspace(1,length(options.corrWindow),5))),-2)./1000,...
        'ylim',yAxisLims)
%     legend({'Controls','Relatives','Psychosis'},'FontSize',7,'Location','NorthWest')
    title('Average Probability of Saccadess')
    ylabel('Probability (%)')
    xlabel('Time Relative to Event Onset (s)')
    box off
    set(gca,'XColor','k','YColor','k')
    
    
    %% Plot averages for full and groups seperately for blinks
    blinkFigAve = figure();
    yAxisLims = [0 3];
    yAxisLimsAve = [0 4.25];
    sigMarkerLoc = 2.9;
    statsLocY = 3.25;
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [11.2837 4.4372];   % Aspect ratio
    figSize.figSize = [0 0 ...
        figSize.baseSize(3)*.75 ...
        (figSize.baseSize(3)*.75)*(figSize.aspectRatio(2)/figSize.aspectRatio(1))];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    set(0, 'DefaultFigureRenderer', 'painters');
    addpath(genpath('/home/shaw-raid1/matlab_tools/css_phcp_analysis.git'))
    
    % Plot average
    % Plot time
    subplot(4,4,[1:3])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
        
    %     plot(data.invCorr.B.corrData_blink_aveFull(3,:),'Color',[0 0 0])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],data.invCorr.B.corrData_blink_aveFull(3,:),...
        data.invCorr.B.corrData_blink_steFull(3,:),[0 0 0],[0 0 0],.25);
    hold on
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Ave)]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Ave==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 0],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',[],...
        'ylim',yAxisLims)
    title('Average Blinks Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,4)
    hb = bar([data.invCorr.B.stats.baseline_blink_Ave data.invCorr.B.stats.peak_blink_Ave data.invCorr.B.stats.trough_blink_Ave]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_blink_Ave data.invCorr.B.stats.peak_blink_Ave data.invCorr.B.stats.trough_blink_Ave],...
        [data.invCorr.B.stats.baseline_blink_Ste data.invCorr.B.stats.peak_blink_Ste data.invCorr.B.stats.trough_blink_Ste],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_blink_AveTtest_p<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_blink_AveTtest_p);
    end
    if data.invCorr.B.stats.trough_blink_AveTtest_p<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.trough_blink_AveTtest_p);
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_blink_AveTtest_stats.df,')=',...
        data.invCorr.B.stats.peak_blink_AveTtest_stats.tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_blink_AveTtest_stats.df,')=',...
        data.invCorr.B.stats.trough_blink_AveTtest_stats.tstat,...
        pPlotHolder2),...
        'FontSize',6);
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',[],'fontsize',10,...
        'YLim',yAxisLimsAve)
    set(hb,'linewidth',2)
    hb(1).FaceColor = [0 0 0];
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Average)')
    
    % Plot controls
    % Plot time
    subplot(4,4,[5:7])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
        
    %     plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(1,3,:)),'Color',[0 1 0])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],squeeze(data.invCorr.B.corrData_blink_aveGrp(1,3,:)),...
        squeeze(data.invCorr.B.corrData_blink_steGrp(1,3,:)),[0 1 0],[0 1 0],.25);
    hold on
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Grp(1,:))]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Grp(1,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 1 0],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',[],...
        'ylim',yAxisLims)
    title('Controls Blinks Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,8)
    hb = bar([data.invCorr.B.stats.baseline_blink_GrpAve(1) data.invCorr.B.stats.peak_blink_GrpAve(1) data.invCorr.B.stats.trough_blink_GrpAve(1)]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_blink_GrpAve(1) data.invCorr.B.stats.peak_blink_GrpAve(1) data.invCorr.B.stats.trough_blink_GrpAve(1)],...
        [data.invCorr.B.stats.baseline_blink_GrpSte(1) data.invCorr.B.stats.peak_blink_GrpSte(1) data.invCorr.B.stats.trough_blink_GrpSte(1)],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_blink_GrpTtest_p(1)<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_blink_GrpTtest_p(1));
    end
    if data.invCorr.B.stats.trough_blink_GrpTtest_p(1)<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.trough_blink_GrpTtest_p(1));
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_blink_GrpTtest_stats(1).df,')=',...
        data.invCorr.B.stats.peak_blink_GrpTtest_stats(1).tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_blink_GrpTtest_stats(1).df,')=',...
        data.invCorr.B.stats.trough_blink_GrpTtest_stats(1).tstat,...
        pPlotHolder2),...
        'FontSize',6);
    clear pPlotHolder1 pPlotHolder2
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',[],'fontsize',10,...
        'YLim',yAxisLimsAve)
    set(hb,'linewidth',2)
    hb(1).FaceColor = col_list{1};
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Controls)')
    
    % Plot relatives
    % Plot time
    subplot(4,4,[9:11])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
        
    %     plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(2,3,:)),'Color',[0 0 1])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],squeeze(data.invCorr.B.corrData_blink_aveGrp(2,3,:)),...
        squeeze(data.invCorr.B.corrData_blink_steGrp(2,3,:)),[0 0 1],[0 0 1],.25);
    hold on
        
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Grp(2,:))]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Grp(2,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 1],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',[],...
        'ylim',yAxisLims)
    title('Relatives Blinks Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,12)
    hb = bar([data.invCorr.B.stats.baseline_blink_GrpAve(2) data.invCorr.B.stats.peak_blink_GrpAve(2) data.invCorr.B.stats.trough_blink_GrpAve(2)]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_blink_GrpAve(2) data.invCorr.B.stats.peak_blink_GrpAve(2) data.invCorr.B.stats.trough_blink_GrpAve(2)],...
        [data.invCorr.B.stats.baseline_blink_GrpSte(2) data.invCorr.B.stats.peak_blink_GrpSte(2) data.invCorr.B.stats.trough_blink_GrpSte(2)],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_blink_GrpTtest_p(2)<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_blink_GrpTtest_p(2));
    end
    if data.invCorr.B.stats.trough_blink_GrpTtest_p(2)<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.trough_blink_GrpTtest_p(2));
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_blink_GrpTtest_stats(2).df,')=',...
        data.invCorr.B.stats.peak_blink_GrpTtest_stats(2).tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_blink_GrpTtest_stats(2).df,')=',...
        data.invCorr.B.stats.trough_blink_GrpTtest_stats(2).tstat,...
        pPlotHolder2),...
        'FontSize',6);
    clear pPlotHolder1 pPlotHolder2
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',[],'fontsize',10,...
        'YLim',yAxisLimsAve)
    set(hb,'linewidth',2)
    hb(1).FaceColor = col_list{2};
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Relatives)')
    
    % Plot psychosis
    % Plot time
    subplot(4,4,[13:15])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
        
    %     plot(squeeze(data.invCorr.B.corrData_blink_aveGrp(3,3,:)),'Color',[1 0 0])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],squeeze(data.invCorr.B.corrData_blink_aveGrp(3,3,:)),...
        squeeze(data.invCorr.B.corrData_blink_steGrp(3,3,:)),[1 0 0],[1 0 0],.25);
    hold on
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_blink_aveGrp)))],'k','LineWidth',1.5)
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestBlink_Sig_Grp(3,:))]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestBlink_Sig_Grp(3,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[1 0 0],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',options.corrWindow([find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)])./1000,...
        'ylim',yAxisLims)
    xlabel('Time Relative to Event Onset (s)')
    title('Psychosis Blinks Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,16)
    hb = bar([data.invCorr.B.stats.baseline_blink_GrpAve(3) data.invCorr.B.stats.peak_blink_GrpAve(3) data.invCorr.B.stats.trough_blink_GrpAve(3)]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_blink_GrpAve(3) data.invCorr.B.stats.peak_blink_GrpAve(3) data.invCorr.B.stats.trough_blink_GrpAve(3)],...
        [data.invCorr.B.stats.baseline_blink_GrpSte(3) data.invCorr.B.stats.peak_blink_GrpSte(3) data.invCorr.B.stats.trough_blink_GrpSte(3)],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_blink_GrpTtest_p(3)<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_blink_GrpTtest_p(3));
    end
    if data.invCorr.B.stats.trough_blink_GrpTtest_p(3)<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.trough_blink_GrpTtest_p(3));
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_blink_GrpTtest_stats(3).df,')=',...
        data.invCorr.B.stats.peak_blink_GrpTtest_stats(3).tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_blink_GrpTtest_stats(3).df,')=',...
        data.invCorr.B.stats.trough_blink_GrpTtest_stats(3).tstat,...
        pPlotHolder2),...
        'FontSize',6);
    clear pPlotHolder1 pPlotHolder2
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',{'Baseline','Peak','Trough'},'fontsize',10,...
        'YLim',yAxisLimsAve)
    set(hb,'linewidth',2)
    hb(1).FaceColor = col_list{3};
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Psychosis)')
    % Add figure y axis title
    han=axes(blinkFigAve,'visible','off');
    han.YLabel.Visible = 'on';
    ylabel(han,sprintf('%s','Probability of Blink (%)'),'FontSize',12)
    suptitle('Illusory Switch Task - Blink Probability');
    
    
    %% Plot averages for full and groups seperately for saccades    
    saccFigAve = figure();
    yAxisLims = [0 13.7];
    yAxisLimsAves = [0 16];
    sigMarkerLoc = 13.3;
    statsLocY = 13;
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [11.2837 4.4372];   % Aspect ratio
    figSize.figSize = [0 0 ...
        figSize.baseSize(3)*.75 ...
        (figSize.baseSize(3)*.75)*(figSize.aspectRatio(2)/figSize.aspectRatio(1))];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    set(0, 'DefaultFigureRenderer', 'painters');
        
    % Plot average
    % Plot time
    subplot(4,4,[1:3])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
    
    %     plot(data.invCorr.B.corrData_sacc_aveFull(3,:),'Color',[0 0 0])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],data.invCorr.B.corrData_sacc_aveFull(3,:),...
        data.invCorr.B.corrData_sacc_steFull(3,:),[0 0 0],[0 0 0],.25);
    hold on
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5)
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Ave)]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Ave==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 0],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',[],...
        'ylim',yAxisLims)
    title('Average Saccades Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,4)
    hb = bar([data.invCorr.B.stats.baseline_sacc_Ave data.invCorr.B.stats.peak_sacc_Ave data.invCorr.B.stats.trough_sacc_Ave]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_sacc_Ave data.invCorr.B.stats.peak_sacc_Ave data.invCorr.B.stats.trough_sacc_Ave],...
        [data.invCorr.B.stats.baseline_sacc_Ste data.invCorr.B.stats.peak_sacc_Ste data.invCorr.B.stats.trough_sacc_Ste],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_sacc_AveTtest_p<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_sacc_AveTtest_p);
    end
    if data.invCorr.B.stats.peak_sacc_AveTtest_p<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_sacc_AveTtest_p);
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_sacc_AveTtest_stats.df,')=',...
        data.invCorr.B.stats.peak_sacc_AveTtest_stats.tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_sacc_AveTtest_stats.df,')=',...
        data.invCorr.B.stats.trough_sacc_AveTtest_stats.tstat,...
        pPlotHolder2),...
        'FontSize',6);
    clear pPlotHolder1 pPlotHolder2
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',[],'fontsize',10,...
        'YLim',yAxisLimsAves)
    set(hb,'linewidth',2)
    hb(1).FaceColor = [0 0 0];
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Average)')
    
    % Plot controls
    % Plot time
    subplot(4,4,[5:7])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
    
    %     plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(1,3,:)),'Color',[0 1 0])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],squeeze(data.invCorr.B.corrData_sacc_aveGrp(1,3,:)),...
        squeeze(data.invCorr.B.corrData_sacc_steGrp(1,3,:)),[0 1 0],[0 1 0],.25);
    hold on
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5);
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Grp(1,:))]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Grp(1,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 1 0],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',[],...
        'ylim',yAxisLims)
    title('Controls Saccades Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,8)
    hb = bar([data.invCorr.B.stats.baseline_sacc_GrpAve(1) data.invCorr.B.stats.peak_sacc_GrpAve(1) data.invCorr.B.stats.trough_sacc_GrpAve(1)]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_sacc_GrpAve(1) data.invCorr.B.stats.peak_sacc_GrpAve(1) data.invCorr.B.stats.trough_sacc_GrpAve(1)],...
        [data.invCorr.B.stats.baseline_sacc_GrpSte(1) data.invCorr.B.stats.peak_sacc_GrpSte(1) data.invCorr.B.stats.trough_sacc_GrpSte(1)],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_sacc_GrpTtest_p(1)<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_sacc_GrpTtest_p(1));
    end
    if data.invCorr.B.stats.trough_sacc_GrpTtest_p(1)<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.trough_sacc_GrpTtest_p(1));
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_sacc_GrpTtest_stats(1).df,')=',...
        data.invCorr.B.stats.peak_sacc_GrpTtest_stats(1).tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_sacc_GrpTtest_stats(1).df,')=',...
        data.invCorr.B.stats.trough_sacc_GrpTtest_stats(1).tstat,...
        pPlotHolder2),...
        'FontSize',6);
    clear pPlotHolder1 pPlotHolder2
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',[],'fontsize',10,...
        'YLim',yAxisLimsAves)
    set(hb,'linewidth',2)
    hb(1).FaceColor = col_list{1};
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Controls)')
    
    % Plot relatives
    % Plot time
    subplot(4,4,[9:11])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
        
    %     plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(2,3,:)),'Color',[0 0 1])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],squeeze(data.invCorr.B.corrData_sacc_aveGrp(2,3,:)),...
        squeeze(data.invCorr.B.corrData_sacc_steGrp(2,3,:)),[0 0 1],[0 0 1],.25);
    hold on
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5)
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Grp(2,:))]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Grp(2,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[0 0 1],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',[],...
        'ylim',yAxisLims)
    title('Relatives Saccades Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,12)
    hb = bar([data.invCorr.B.stats.baseline_sacc_GrpAve(2) data.invCorr.B.stats.peak_sacc_GrpAve(2) data.invCorr.B.stats.trough_sacc_GrpAve(2)]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_sacc_GrpAve(2) data.invCorr.B.stats.peak_sacc_GrpAve(2) data.invCorr.B.stats.trough_sacc_GrpAve(2)],...
        [data.invCorr.B.stats.baseline_sacc_GrpSte(2) data.invCorr.B.stats.peak_sacc_GrpSte(2) data.invCorr.B.stats.trough_sacc_GrpSte(2)],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_sacc_GrpTtest_p(2)<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_sacc_GrpTtest_p(2));
    end
    if data.invCorr.B.stats.trough_sacc_GrpTtest_p(2)<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.trough_sacc_GrpTtest_p(2));
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_sacc_GrpTtest_stats(2).df,')=',...
        data.invCorr.B.stats.peak_sacc_GrpTtest_stats(2).tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_sacc_GrpTtest_stats(2).df,')=',...
        data.invCorr.B.stats.trough_sacc_GrpTtest_stats(2).tstat,...
        pPlotHolder2),...
        'FontSize',6);
    clear pPlotHolder1 pPlotHolder2
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',[],'fontsize',10,...
        'YLim',yAxisLimsAves)
    set(hb,'linewidth',2)
    hb(1).FaceColor = col_list{2};
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Relatives)')
    
    % Plot psychosis
    % Plot time
    subplot(4,4,[13:15])
    % Plot windows of peak
    %     plot([peakRange(1) peakRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    %     plot([peakRange(end) peakRange(end)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.8 .8 .8],'LineWidth',1);
    patch([peakRange(1),peakRange(end),peakRange(end),peakRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.9 .9 .9],'LineStyle','none')
    
    % Plot windows of trough
    %     plot([troughRange(1) troughRange(1)],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    %     plot([troughRange(end)-1 troughRange(end)-1],...
    %         [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'--','Color',[.4 .4 .4],'LineWidth',1);
    patch([troughRange(1),troughRange(end),troughRange(end),troughRange(1)],...
            [0,0,max(max(max(data.invCorr.B.corrData_sacc_aveGrp))),max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],...
            [.6 .6 .6],'LineStyle','none')
        
    %     plot(squeeze(data.invCorr.B.corrData_sacc_aveGrp(3,3,:)),'Color',[1 0 0])
    % Plot error shades for the line
    % function h = mpsErrorplot(x, y, e, plotColor, ebColor, ebAlpha)
    % plot color is the line color
    % eb color is the background shading for the error
    % and then ebAlpha is an optional transparency value
    mpsErrorplot([1:length(options.corrWindow)],squeeze(data.invCorr.B.corrData_sacc_aveGrp(3,3,:)),...
        squeeze(data.invCorr.B.corrData_sacc_steGrp(3,3,:)),[1 0 0],[1 0 0],.25);
    hold on    
    
    % Mark behav event onset
    plot([find(options.corrWindow==0) find(options.corrWindow==0)],...
        [0 max(max(max(data.invCorr.B.corrData_sacc_aveGrp)))],'k','LineWidth',1.5);
    
    % Plot significance markers
    plotMarker = zeros([1 length(data.invCorr.B.stats.ttestSacc_Sig_Grp(3,:))]) + sigMarkerLoc; % Plot val
    plotMarker(data.invCorr.B.stats.ttestSacc_Sig_Grp(3,:)==0) = NaN;
    plot([1:length(options.corrWindow)], plotMarker,'Color',[1 0 0],'LineWidth',1.5)
    clear plotMarker
    
    set(gca,'xlim',[find(options.corrWindow==-2000) find(options.corrWindow==2000)],...
        'xtick',[find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)],...
        'xticklabels',options.corrWindow([find(options.corrWindow==-2000) find(options.corrWindow==-1000) ...
            find(options.corrWindow==0) find(options.corrWindow==1000) find(options.corrWindow==2000)])./1000,...
        'ylim',yAxisLims)
    xlabel('Time Relative to Event Onset (s)')
    title('Psychosis Saccades Surrounding Behavioral Event')
    box off
    set(gca,'XColor','k','YColor','k')
    
    % Plot averaged time windows
    subplot(4,4,16)
    hb = bar([data.invCorr.B.stats.baseline_sacc_GrpAve(3) data.invCorr.B.stats.peak_sacc_GrpAve(3) data.invCorr.B.stats.trough_sacc_GrpAve(3)]);
    hold on
    errorbar([1:3],...
        [data.invCorr.B.stats.baseline_sacc_GrpAve(3) data.invCorr.B.stats.peak_sacc_GrpAve(3) data.invCorr.B.stats.trough_sacc_GrpAve(3)],...
        [data.invCorr.B.stats.baseline_sacc_GrpSte(3) data.invCorr.B.stats.peak_sacc_GrpSte(3) data.invCorr.B.stats.trough_sacc_GrpSte(3)],...
        '.k','linewidth',2)
    
    % Plot stats
    if data.invCorr.B.stats.peak_sacc_GrpTtest_p(3)<0.001
        pPlotHolder1 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder1 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.peak_sacc_GrpTtest_p(3));
    end
    if data.invCorr.B.stats.trough_sacc_GrpTtest_p(3)<0.001
        pPlotHolder2 = sprintf('%s%.3f',', p<',0.001);
    else
        pPlotHolder2 = sprintf('%s%.3f',', p=',data.invCorr.B.stats.trough_sacc_GrpTtest_p(3));
    end
    text(.75,statsLocY,sprintf('%s%d%s%.3f%s\n%s%d%s%.3f%s',...
        'Peak sig.: t(',...
        data.invCorr.B.stats.peak_sacc_GrpTtest_stats(3).df,')=',...
        data.invCorr.B.stats.peak_sacc_GrpTtest_stats(3).tstat,...
        pPlotHolder1,...
        'Trough sig.: t(',...
        data.invCorr.B.stats.trough_sacc_GrpTtest_stats(3).df,')=',...
        data.invCorr.B.stats.trough_sacc_GrpTtest_stats(3).tstat,...
        pPlotHolder2),...
        'FontSize',6);
    clear pPlotHolder1 pPlotHolder2
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',{'Baseline','Peak','Trough'},'fontsize',10,...
        'YLim',yAxisLimsAves)
    set(hb,'linewidth',2)
    hb(1).FaceColor = col_list{3};
    set(gca,'XTick',1:3,'fontsize',7)
    
    box off
    set(gca,'XColor','k','YColor','k')
    title('Averaged Time Windows (Psychosis)')
    % Add figure y axis title
    han=axes(saccFigAve,'visible','off');
    han.YLabel.Visible = 'on';
    ylabel(han,sprintf('%s','Probability of Saccade (%)'),'FontSize',12)
    suptitle('Illusory Switch Task - Saccade Probability');
    
    %% Plot blink peak/trough windows for each group
    yAxisRange = [0 4];
    statsPlotOffsetY = .25;
    statsPlotOffsetX = 1.6;
    peakTroughFig_Blink = figure();
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [11.2837 3.1432];   % Aspect ratio
    figSize.figSize = [0 0 ...
        figSize.baseSize(3)*.75 ...
        (figSize.baseSize(3)*.75)*(figSize.aspectRatio(2)/figSize.aspectRatio(1))];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    
    % Peak
    subplot(1,2,1)
    hb1 = bar(1,[data.invCorr.B.stats.peak_blink_GrpAve(1)]);
    hold on
    hb2 = bar(2,[data.invCorr.B.stats.peak_blink_GrpAve(2)]);
    hb3 = bar(3,[data.invCorr.B.stats.peak_blink_GrpAve(3)]);
    errorbar([1:3],...
        [data.invCorr.B.stats.peak_blink_GrpAve(:)], ...
        [data.invCorr.B.stats.peak_blink_GrpSte(:)], ...
        '.k','linewidth',2);
    
    % Plot beeswarms
    x_val = [hb1.XData hb2.XData hb3.XData];
    bee_bin_width = .1;
    bee_spread_width = 1.25;
    beePlot = plotSpread({nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(...
        data.et.B.grpIdx{1},3,peakRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(...
        data.et.B.grpIdx{2},3,peakRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(...
        data.et.B.grpIdx{3},3,peakRange)),2)},...
        'binWidth', bee_bin_width,...
        'distributionColors', {[.5 .5 .5]},...
        'xValues', x_val,...
        'spreadWidth', bee_spread_width);
    set(beePlot{1},'MarkerSize',10)
    
    % Plot stats
    % ANOVAN
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY,sprintf('%s%d%s%d%s%.3f%s%.3f%s%.3f',...
        'Blink peak sig.: F(',...
        data.invCorr.B.stats.anovanPeak_Blink.Table_peak{2,3},',',...
        data.invCorr.B.stats.anovanPeak_Blink.Table_peak{5,3},')=',...
        data.invCorr.B.stats.anovanPeak_Blink.Table_peak{2,6},...
        ', p=',data.invCorr.B.stats.anovanPeak_Blink.Table_peak{2,7}),...
        'FontSize',6);
    % KW3
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*2,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Blink peak sig.: X2(',...
        data.invCorr.B.stats.KW3_Peak_Blink.Table_peak{2,3},')=',...
        data.invCorr.B.stats.KW3_Peak_Blink.Table_peak{2,5},...
        ', p=',data.invCorr.B.stats.KW3_Peak_Blink.Table_peak{2,6}),...
        'FontSize',6);
    % KW2 - Controls vs Probands
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*3,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Blink peak (CvP) sig.: X2(',...
        data.invCorr.B.stats.KW2_Peak_Blink.Table_peak{2,3},')=',...
        data.invCorr.B.stats.KW2_Peak_Blink.Table_peak{2,5},...
        ', p=',data.invCorr.B.stats.KW2_Peak_Blink.Table_peak{2,6}),...
        'FontSize',6);
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',{'Controls','Relatives','Probands'},'fontsize',10,...
        'YLim',yAxisRange,'fontsize',12)
    set(hb1,'linewidth',2)
    set(hb2,'linewidth',2)
    set(hb3,'linewidth',2)
    hb1(1).FaceColor = col_list{1};
    hb2(1).FaceColor = col_list{2};
    hb3(1).FaceColor = col_list{3};
    
    box off
    ylabel('Probability of Blink (%)')
    set(gca,'XColor','k','YColor','k')
    title('Probability of Blink During Peak')
    
    % Trough
    subplot(1,2,2)
    hb1 = bar(1,[data.invCorr.B.stats.trough_blink_GrpAve(1)]);
    hold on
    hb2 = bar(2,[data.invCorr.B.stats.trough_blink_GrpAve(2)]);
    hb3 = bar(3,[data.invCorr.B.stats.trough_blink_GrpAve(3)]);
    errorbar([1:3],...
        [data.invCorr.B.stats.trough_blink_GrpAve(:)], ...
        [data.invCorr.B.stats.trough_blink_GrpSte(:)], ...
        '.k','linewidth',2);
    
    % Plot beeswarms
    x_val = [hb1.XData hb2.XData hb3.XData];
    bee_bin_width = .1;
    bee_spread_width = 1.25;
    beePlot = plotSpread({nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(...
        data.et.B.grpIdx{1},3,troughRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(...
        data.et.B.grpIdx{2},3,troughRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_blink_aveDay(...
        data.et.B.grpIdx{3},3,troughRange)),2)},...
        'binWidth', bee_bin_width,...
        'distributionColors', {[.5 .5 .5]},...
        'xValues', x_val,...
        'spreadWidth', bee_spread_width);
    set(beePlot{1},'MarkerSize',10)
    
    % Plot stats
    % ANOVAN
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY,sprintf('%s%d%s%d%s%.3f%s%.3f%s%.3f',...
        'Blink trough sig.: F(',...
        data.invCorr.B.stats.anovanTrough_Blink.Table_trough{2,3},',',...
        data.invCorr.B.stats.anovanTrough_Blink.Table_trough{5,3},')=',...
        data.invCorr.B.stats.anovanTrough_Blink.Table_trough{2,6},...
        ', p=',data.invCorr.B.stats.anovanTrough_Blink.Table_trough{2,7}),...
        'FontSize',6);
    % KW3
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*2,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Blink trough sig.: X2(',...
        data.invCorr.B.stats.KW3_Trough_Blink.Table_trough{2,3},')=',...
        data.invCorr.B.stats.KW3_Trough_Blink.Table_trough{2,5},...
        ', p=',data.invCorr.B.stats.KW3_Trough_Blink.Table_trough{2,6}),...
        'FontSize',6);
    % KW2 - Controls vs Probands
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*3,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Blink trough (CvP) sig.: X2(',...
        data.invCorr.B.stats.KW2_Trough_Blink.Table_trough{2,3},')=',...
        data.invCorr.B.stats.KW2_Trough_Blink.Table_trough{2,5},...
        ', p=',data.invCorr.B.stats.KW2_Trough_Blink.Table_trough{2,6}),...
        'FontSize',6);
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',{'Controls','Relatives','Probands'},'fontsize',10,...
        'YLim',yAxisRange,'fontsize',12)
    set(hb1,'linewidth',2)
    set(hb2,'linewidth',2)
    set(hb3,'linewidth',2)
    hb1(1).FaceColor = col_list{1};
    hb2(1).FaceColor = col_list{2};
    hb3(1).FaceColor = col_list{3};
    
    box off
    ylabel('Probability of Blink (%)')
    set(gca,'XColor','k','YColor','k')
    title('Probability of Blink During Trough')
    suptitle('Illusory Switch Task - Blink Probability');
    
    %% Plot sacc peak/trough windows for each group
    yAxisRange = [0 25];
    statsPlotOffsetY = 1.5;
    statsPlotOffsetX = 1.6;
    peakTroughFig_Sacc = figure();
    figSize.baseSize = get(0,'Screensize');   % Base size in pixels
    figSize.aspectRatio = [11.2837 3.1432];   % Aspect ratio
    figSize.figSize = [0 0 ...
        figSize.baseSize(3)*.75 ...
        (figSize.baseSize(3)*.75)*(figSize.aspectRatio(2)/figSize.aspectRatio(1))];   % Size/postion of fig
    set(gcf,'color','w')
    set(gcf,'Position', figSize.figSize)
    
    % Peak
    subplot(1,2,1)
    hb1 = bar(1,[data.invCorr.B.stats.peak_sacc_GrpAve(1)]);
    hold on
    hb2 = bar(2,[data.invCorr.B.stats.peak_sacc_GrpAve(2)]);
    hb3 = bar(3,[data.invCorr.B.stats.peak_sacc_GrpAve(3)]);
    errorbar([1:3],...
        [data.invCorr.B.stats.peak_sacc_GrpAve(:)], ...
        [data.invCorr.B.stats.peak_sacc_GrpSte(:)], ...
        '.k','linewidth',2);
    
    % Plot beeswarms
    x_val = [hb1.XData hb2.XData hb3.XData];
    bee_bin_width = .1;
    bee_spread_width = 1.25;
    beePlot = plotSpread({nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(...
        data.et.B.grpIdx{1},3,peakRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(...
        data.et.B.grpIdx{2},3,peakRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(...
        data.et.B.grpIdx{3},3,peakRange)),2)},...
        'binWidth', bee_bin_width,...
        'distributionColors', {[.5 .5 .5]},...
        'xValues', x_val,...
        'spreadWidth', bee_spread_width);
    set(beePlot{1},'MarkerSize',10)
    
    % Plot stats
    % ANOVAN
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY,sprintf('%s%d%s%d%s%.3f%s%.3f%s%.3f',...
        'Sacc peak sig.: F(',...
        data.invCorr.B.stats.anovanPeak_Sacc.Table_peak{2,3},',',...
        data.invCorr.B.stats.anovanPeak_Sacc.Table_peak{5,3},')=',...
        data.invCorr.B.stats.anovanPeak_Sacc.Table_peak{2,6},...
        ', p=',data.invCorr.B.stats.anovanPeak_Sacc.Table_peak{2,7}),...
        'FontSize',6);
    % KW3
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*2,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Sacc peak sig.: X2(',...
        data.invCorr.B.stats.KW3_Peak_Sacc.Table_peak{2,3},')=',...
        data.invCorr.B.stats.KW3_Peak_Sacc.Table_peak{2,5},...
        ', p=',data.invCorr.B.stats.KW3_Peak_Sacc.Table_peak{2,6}),...
        'FontSize',6);
    % KW2 - Controls vs Probands
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*3,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Sacc peak (CvP) sig.: X2(',...
        data.invCorr.B.stats.KW2_Peak_Sacc.Table_peak{2,3},')=',...
        data.invCorr.B.stats.KW2_Peak_Sacc.Table_peak{2,5},...
        ', p=',data.invCorr.B.stats.KW2_Peak_Sacc.Table_peak{2,6}),...
        'FontSize',6);
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',{'Controls','Relatives','Probands'},'fontsize',10,...
        'YLim',yAxisRange,'fontsize',12)
    set(hb1,'linewidth',2)
    set(hb2,'linewidth',2)
    set(hb3,'linewidth',2)
    hb1(1).FaceColor = col_list{1};
    hb2(1).FaceColor = col_list{2};
    hb3(1).FaceColor = col_list{3};
    
    box off
    ylabel('Probability of Saccade (%)')
    set(gca,'XColor','k','YColor','k')
    title('Probability of Saccade During Peak')
    
    % Trough
    subplot(1,2,2)
    hb1 = bar(1,[data.invCorr.B.stats.trough_sacc_GrpAve(1)]);
    hold on
    hb2 = bar(2,[data.invCorr.B.stats.trough_sacc_GrpAve(2)]);
    hb3 = bar(3,[data.invCorr.B.stats.trough_sacc_GrpAve(3)]);
    errorbar([1:3],...
        [data.invCorr.B.stats.trough_sacc_GrpAve(:)], ...
        [data.invCorr.B.stats.trough_sacc_GrpSte(:)], ...
        '.k','linewidth',2);
    
    % Plot beeswarms
    x_val = [hb1.XData hb2.XData hb3.XData];
    bee_bin_width = .1;
    bee_spread_width = 1.25;
    beePlot = plotSpread({nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(...
        data.et.B.grpIdx{1},3,troughRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(...
        data.et.B.grpIdx{2},3,troughRange)),2),...
        nanmean(squeeze(data.invCorr.B.corrData_sacc_aveDay(...
        data.et.B.grpIdx{3},3,troughRange)),2)},...
        'binWidth', bee_bin_width,...
        'distributionColors', {[.5 .5 .5]},...
        'xValues', x_val,...
        'spreadWidth', bee_spread_width);
    set(beePlot{1},'MarkerSize',10)
    
    % Plot stats
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY,sprintf('%s%d%s%d%s%.3f%s%.3f%s%.3f',...
        'Sacc trough sig.: F(',...
        data.invCorr.B.stats.anovanTrough_Sacc.Table_trough{2,3},',',...
        data.invCorr.B.stats.anovanTrough_Sacc.Table_trough{5,3},')=',...
        data.invCorr.B.stats.anovanTrough_Sacc.Table_trough{2,6},...
        ', p=',data.invCorr.B.stats.anovanTrough_Sacc.Table_trough{2,7}),...
        'FontSize',6);
    % KW3
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*2,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Sacc trough sig.: X2(',...
        data.invCorr.B.stats.KW3_Trough_Sacc.Table_trough{2,3},')=',...
        data.invCorr.B.stats.KW3_Trough_Sacc.Table_trough{2,5},...
        ', p=',data.invCorr.B.stats.KW3_Trough_Sacc.Table_trough{2,6}),...
        'FontSize',6);
    % KW2 - Controls vs Probands
    text(statsPlotOffsetX,yAxisRange(2)-statsPlotOffsetY*3,sprintf('%s%d%s%.3f%s%.3f%s%.3f',...
        'Sacc trough (CvP) sig.: X2(',...
        data.invCorr.B.stats.KW2_Trough_Sacc.Table_trough{2,3},')=',...
        data.invCorr.B.stats.KW2_Trough_Sacc.Table_trough{2,5},...
        ', p=',data.invCorr.B.stats.KW2_Trough_Sacc.Table_trough{2,6}),...
        'FontSize',6);
    
    set(gca,'XTick',1:3,'XLim',[.5 3.5],'XTickLabel',{'Controls','Relatives','Probands'},'fontsize',10,...
        'YLim',yAxisRange,'fontsize',12)
    set(hb1,'linewidth',2)
    set(hb2,'linewidth',2)
    set(hb3,'linewidth',2)
    hb1(1).FaceColor = col_list{1};
    hb2(1).FaceColor = col_list{2};
    hb3(1).FaceColor = col_list{3};
    
    box off
    ylabel('Probability of Saccade (%)')
    set(gca,'XColor','k','YColor','k')
    title('Probability of Saccade During Trough')
    suptitle('Illusory Switch Task - Saccade Probability');
    
end
end
